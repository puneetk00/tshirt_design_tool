
var fonts = ["Abel Regular", "Alittlesunshine", "Abel Regular", "Aegis", "Aegis 3D", "Aegis 3D Italic", "Aegis Condensed", "Aegis Condensed Italic", "Aegis Expanded", "Aegis Expanded Italic", "AegisItalic", "AegisLeftalic", "Aerovias BrasilNF", "AirAmericana", "Air Mill house Italic", "Air Mill house Outline", "AirstreamNF", "Airstrike", "Airstrike3D", "Airstrike Academy", "Airstrike Bold 3D", "Airstrike Bold", "Airstrike Bullet", "Airstrike Chrome", "Airstrike Condensed", "Airstrike Expanded", "Airstrike Gradient", "AirstrikeHalf Tone", "Airstrike Laser", "Airstrike Out line", "Airstrike Platinum", "All Things Pink Skinny", "All Things Pink", "Allana Regular", "Always Forever", "Always In MyHeart", "Always Here", "Ancherr Personal", "Angelina", "Angilla Tattoo Personal Use", "Anglo Saxon Italic", "Anita Semi square", "Aquawax Black", "Aquawax Light", "Aquawax Medium", "Archeologicaps", "Are You Freak in Serious", "Arial Black", "Arial Bold Italic MT", "Arial Bold MT", "Arial Italic MT", "Arial Narrow Bold Italic", "Arial Narrow Bold", "Arial Narrow Italic", "Arial Narrow", "Arial MT", "Atiba Regular", "Augusta Shadow", "Augusta", "Colors of Autumn", "AvQest", "AYear Without Rain", "Bakery", "BalladeContour", "Ballade Bold", "Barefootbluejeannight", "Beacon", "Beauty School DropoutII", "BebasNeue", "Bellota Bold", "Bellota Bold Italic", "Bellota Italic", "Bellota Light", "Bellota Light Italic", "Bellota Regular", "BendableBRK", "BarberStreetPersonalUseOnly", "BettyNoir", "BewilderBRK", "BewilderThickBRK", "Biergarten", "Biergartenc", "Biergartene", "Biergartenei", "Biergarteni", "Biergartenlti", "Biergarteni", "Biergartenl", "Biergartenr", "Biergartenri", "Biergartenrie", "Biergartenril", "Biergartenris", "Biergartens", "Biergartensi", "BigNoodleTitling", "BigNoodleTitling Oblique", "Blackstar", "Blade", "Bubbleboddy Fat", "Bubbleboddylight Light", "BobcaygeonBRK", "BobcaygeonPlainBRK", "BoogieNightsShadowNF", "Borders Divide ButHeartsShallConquer", "Bowhouse Black", "Bowhouse Bold", "Bowhouse Light", "Bowhouse Regular", "Breamcatcher", "Bricklane", "Bridgnorth", "Bridgnorth Bold", "Bridgnorth Blocked", "Bridgnorth Shadow", "Briocheau Potiron", "Broadway Event", "BrushScript MT", "BrushHand New", "BRUSHSTRIKE", "BurgerJointJL", "Chocolate Box", "ChocolateBox Decorative", "Caesar Dressing", "cafeandbrewery", "Calibri BoldItalic", "Calibri Bold", "Calibri Italic", "calibrush", "CarbonBlock", "Carrington", "CaviarDreams Bold", "CaviarDreams", "CaviarDreams Bold Italic", "CaviarDreams Italic", "Celtic Garamondthe2nd", "celtic", "CelticHand", "CFParis 7Regular", "Chalkduster", "ChampagneLimousines BoldItalic", "ChampagneLimousines Bold", "ChampagneLimousines Italic", "ChampagneLimousines Italic", "chandstate", "Chocolate Covered Rain drops", "Chocolate Covered Rain drops Hollow", "Chocolate Covered Rain drops", "Cimbrian", "cinnamoncake", "Circled", "CircusOrnate", "Cirqua", "CityBirds", "CityBirds", "CloisterBlack Light", "CoalhandLukeTRIAL", "CoalhandLukeTRIAL", "Colwell", "Colwell Alternates", "ComicSansMS Bold", "ComicSansMS", "ConeriaScript", "ConeriaScriptSlanted", "CONJECTURE", "CollinsOE", "CookieMonster", "Coolvetica", "CorelDraw", "Courgette", "CourierNewPS BoldItalicMT", "CourierNewPS BoldMT", "CourierNewPS ItalicMT", "CourierNewPSMT", "CrackdownR2BRK", "Creampuff", "Crixus", "Crixus3D", "CrixusAcademy", "CrixusAcademy Italic", "CrixusCondensed Italic", "CrixusExpanded Italic", "CrixusItalic", "CrixusLaser", "CrixusLaserItalic", "CrixusLeftalic", "CrackdownRBRK", "CrackdownO1BRK", "CrackdownO2BRK", "CroissantOne Regular", "cronus italic", "cronus round", "Cutie Patootie", "CutiePatootie Hollow", "CutiePatootieSkinny", "CuxhavenTimes", "CyberCaligraphic", "DaddysGirl", "Dalek", "DancingScript Bold", "DancingScript", "Daniel Black", "Daniel", "DanielBold", "DawningofaNewDay", "DayPosterShadowNF", "dc_o", "dc_s", "derepublica", "Deutsch Gothic", "Digory Doodles PS", "DorovarFLF Carolus", "Dunkin BoldItalic", "Dunkin Bold", "Dunkin Italic", "DunkinSans Bold Italic", "DunkinSans Bold", "DunkinSans Italic", "DunkinSans", "Dunkin", "DymaxionScript", "EagleLake Regular", "EasyRider", "Economica Bold", "Economica Bold Italic", "Economica Italic", "Economica Regular", "embossed germanica", "enchanted land", "EnglishGothic17thc", "EnglishTowne Medium", "erlan", "eternalknight", "eternalknight3d", "eternalknight3d", "eternalknightbold", "eternalknightboldital", "eternalknightcond", "eternalknightexpandital", "eternalknightexpand", "eternalknightital", "eternalknightlaserital", "eternalknightlaser", "eternalknightleft", "EternityNow", "evanescent", "evanescent_p", "Exo Black", "Exo ExtraBoldItalic", "Exo Bold", "Exo BoldItalic", "Exo ExtraBold", "Exo ExtraBoldItalic", "Exo ExtraLight", "Exo ExtraLightItalic", "Exo Italic", "Exo Light", "Exo LightItalic", "Exo Medium", "Exo MediumItalic", "Exo Regular", "Exo DemiBold", "Exo DemiBoldItalic", "Exo Thin", "Exo ThinItalic", "FeaturedItem", "FederalEscort", "FederalEscort3D", "FederalEscort3DItalic", "FederalEscortBullet", "FederalEscortBulletItalic", "FederalEscortChrome", "FederalEscortChromeItalic", "FederalEscortCondensed", "FederalEscortCondensedItalic", "FederalEscortExpanded", "FederalEscortExpandedItalic", "FederalEscortHalftone", "FederalEscortHalftoneItalic", "FederalEscortItalic", "FederalEscortLaser", "FederalEscortLaserItalic", "FederalEscortLeftalic", "FederalEscortOutline", "FederalEscortOutlineItalic", "FederalEscortScanlines", "FederalEscortScanlinesItalic", "FederalEscortSemi Italic", "FederalService", "FederalService3D", "FederalService3DItalic", "FederalServiceAcademy", "FederalServiceAcademyItalic", "FederalServiceBold", "FederalServiceBoldItalic", "FederalServiceCondensed", "FederalServiceCondensedItalic", "FederalServiceExpanded", "FederalServiceExpandedBold", "FederalServiceExtraBoldItalic", "FederalServiceItalic", "FederalServiceLaser", "FederalServiceLaserItalic", "FederalServiceLeftalic", "FederalServiceLight", "FederalServiceLightCondensed", "FederalServiceLightCondensedItalic", "FederalServiceLightItalic", "Flamenco Light", "Flamenco Regular", "fluted germanica", "Folkard", "FoolForLove", "FoolForLove", "ForgetMeNot", "FranklinGothic BookItalic", "FranklinGothic Book", "frozenberries", "FlutSaus", "FutureForces", "FutureForces3D", "FutureForces3DItalic", "FutureForcesCondensed", "FutureForcesExpanded", "FutureForcesExpandedItalic", "FutureForcesHalftone", "FutureForcesHalftoneItalic", "FutureForcesItalic", "FutureForcesLaser", "FutureForcesLeftalic", "FutureForcesTitle", "FutureForcesTitleItalic", "FutureForcesSemi Italic", "FutureForcesSuper Italic", "Gaban Italic", "Gaban", "GatsbyFLF Bold", "GatsbyFLF BoldItalic", "GatsbyFLF Italic", "GatsbyFLF", "AncientGeek", "GentlemanCaller", "GentlemanCaller3D", "GentlemanCaller3DItalic", "GentlemanCallerCondensed", "GentlemanCallerCondensedItalic", "GentlemanCallerExpanded", "GentlemanCallerExpandedItalic", "GentlemanCallerItalic", "GentlemanCallerLeftalic", "GentlemanCallerOutline", "GentlemanCallerOutlineItalic", "GentlemanCallerRotalic", "GentlemanCallerRotated", "Georgia BoldItalic", "Georgia Bold", "Georgia Italic", "Georgia", "GirlsHaveManySecrets", "GistLight", "GistRoughUpr Exbold Two", "GistUprightExtrabold", "Glamourgirl", "GlossAndBloom", "gloss and bloom", "goldoni", "GoodDay", "GoodTimes", "GoodVibes", "GramophoneShadedNF", "GrandNational", "GrandNational3D", "GrandNational3DItalic", "GrandNationalCondensed", "GrandNationalCondensedItalic", "GrandNationalExpanded", "GrandNationalExpandedItalic", "GrandNationalItalic", "GrandNationalLaser", "GrandNationalLaserItalic", "GrandNationalLeftalic", "GrandNationalSemi Italic", "GrandNationalSuper Italic", "granger regular", "GrecianFormula", "GreeKish", "Grouser", "Gruppo", "HandOfSean", "Handwriting", "Harabara", "Harrington", "Hashtagsselfies", "Heorot", "HeorotExpanded", "HeorotExpandedItalic", "HeorotItalic", "HeorotShadow", "HeorotShadowItalic", "HeyPrettyGirl", "HighlandGothicFLF Bold", "HighlandGothicFLF", "HighlandGothicLightFLF", "Hitman Regular", "Hole Hearted"];

fonts.unshift('Arial');
// Populate the fontFamily select
var select = document.getElementById("fontFamily");
fonts.forEach(function (font) {
    var option = document.createElement('option');
    option.innerHTML = font;
    option.value = font;
    select.appendChild(option);
});



// Apply selected font on change
document.getElementById('fontFamily').onchange = function (e) {
    if (this.value !== 'Arial') {
        loadAndUse(this.value);
    } else if (front === 'block') {
        canvas.getActiveObject().set("fontFamily", this.value);
        canvas.getActiveObject().setCoords();
        detetBtn();
        canvas.renderAll();
    } else {
        canvasBack.getActiveObject().set("fontFamily", this.value);
        canvasBack.getActiveObject().setCoords();
        detetBtn();
        canvasBack.renderAll();
    }
};

function detetBtn() {
    let canTrX = canvas.getActiveObject().aCoords.tr.x;
    let canTrY = canvas.getActiveObject().aCoords.tr.y;
    addDeleteBtn(canTrX, canTrY);
}

function detetBtnBack() {
    let canTrX = canvasBack.getActiveObject().aCoords.tr.x;
    let canTrY = canvasBack.getActiveObject().aCoords.tr.y;
    addDeleteBtnBack(canTrX, canTrY);
}

function loadAndUse(font) {
    let front = $('#front-view').css('display');
    var myfont = new FontFaceObserver(font)
    myfont.load()
        .then(function () {
            if (front === 'block') {
                canvas.getActiveObject().set("fontFamily", font);
                canvas.getActiveObject().setCoords();
                detetBtn();
                canvas.renderAll();
            } else {
                canvasBack.getActiveObject().set("fontFamily", font);
                canvasBack.getActiveObject().setCoords();
                detetBtnBack();
                canvasBack.renderAll();
            }
        }).catch(function (e) {
            console.log(e)
            alert('font loading failed ' + font);
        });
}